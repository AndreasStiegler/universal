Flow Manager
===

The flow manager is responsible for the overall orchestration of the various subcomponents which comprise the GPII personalization architecture. It:

- is able to be notified by the user listener.
- queries the preferences server for user preferences.
- queries the solutions reporter for available solutions.
- communicates with the matchmaker.
- communicates with the launch manager.

### Dependencies

- [infusion](https://github.com/fluid-project/infusion) framework.

### Installation

Run the following command in your newly checked out universal repository. This
will pull all dependencies that are required by universal.

    npm install

### Flow Manager API

The app currently supports the following urls:

    // LOCAL DEPLOYMENT
    {urlToFlowManager}/user/{userName}/login // GET
    {urlToFlowManager}/user/{uesrName}/logout // GET

    // CLOUD BASED DEPLOYMENT
    {urlToFlowManager}/user/{userName}/login // POST with {device: "..."} payload.
    {urlToFlowManager}/user/{uesrName}/logout // GET

For example:

    {urlToFlowManager}/user/andrei/login // GET
    {urlToFlowManager}/user/andrei/login // POST with
    // {"device": {"OS":{"id": "linux", "version": "2.6.26"}}, "solutions": ...}
    {urlToFlowManager}/user/nisha/logout // GET

### Run

To run flow manager app simply type:

    [NODE_ENV={environment}] node node_modules/kettle/lib/init.js path/to/flowManager/configs/folder
    [NODE_ENV={environment}] node node_modules/kettle/lib/init.js path/to/gpii/configs/folder   // That folder contains configs for other configurations that inlcude Flow Manager.

- Default environment is development.
- Path to configs folder can be absolute or relative to the current user directory.

For example:

    node node_modules/kettle/lib/init.js gpii/node_modules/flowManager/configs/
    NODE_ENV=production node node_modules/kettle/lib/init.js /Users/{userName}/universal/gpii/node_modules/flowManager/configs/
    NODE_ENV=fm.ps.sr.dr.mm.development node node_modules/kettle/lib/init.js gpii/configs/