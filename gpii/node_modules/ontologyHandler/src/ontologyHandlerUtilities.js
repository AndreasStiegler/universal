/*!
GPII Ontology Server Utilities

Copyright 2012 OCAD University
Copyright 2014 Raising the floor - international

Licensed under the New BSD license. You may not use this file except in
compliance with this License.

You may obtain a copy of the License at
https://github.com/gpii/universal/LICENSE.txt
*/

/* global require */

var fluid = fluid || require("infusion");
    utils = fluid.registerNamespace("gpii.ontologyHandler.utils"),
    $ = fluid.registerNamespace("jQuery");

utils.filter = function (full, remove) {
    var modified = false;
    var ret = ($.isArray(full)) ? [] : {};
    for (var ind in full) {
        if (ind in remove) {
            if (fluid.isPrimitive(remove[ind]) || $.isArray(remove[ind])) {
                continue;
            } else {
                var res = utils.filter(full[ind], remove[ind]);
                if (res === undefined)
                    continue;

                ret[ind] = res;
                modified = true;
            }
        } else {
            ret[ind] = full[ind];
            modified = true;
        }
    }
    return modified ? ret : undefined;
};

utils.filterPrefs = function (fullSet, toRemove) {
    var cpy = fluid.copy(fullSet);
    var result = utils.filter(cpy, toRemove);
    console.log(JSON.stringify(result));
    return result;
};